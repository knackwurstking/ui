(function(l,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(l=typeof globalThis<"u"?globalThis:l||self,u(l.ui={}))})(this,function(l){"use strict";class u{constructor(){this.listeners={}}addListener(e,t){return this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t),()=>this.removeListener(e,t)}removeListener(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(s=>s!==t))}dispatch(e,t){this.listeners[e]&&this.listeners[e].forEach(s=>s(t))}}class S{constructor(e){this.prefix="",this.events=new u,this.data={},this.prefix=e}delete(e,t){t!=null&&t.skipStore||localStorage.removeItem(`${this.prefix}${e}`),delete this.data[e]}get(e,t){if(!(t!=null&&t.skipStore)){const s=localStorage.getItem(`${this.prefix}${e}`);if(s!==null)return JSON.parse(s)}if(this.data.hasOwnProperty(e))return this.data[e]}set(e,t,s=!1,n){if(s){let i=null;n!=null&&n.skipStore?i=null:i=localStorage.getItem(`${this.prefix}${e}`),i!==null?this.data[e]=JSON.parse(i):this.data.hasOwnProperty(e)||(this.data[e]=t)}else this.data[e]=t;n!=null&&n.skipStore||localStorage.setItem(`${this.prefix}${e}`,JSON.stringify(this.data[e])),this.events.dispatch(e,this.data[e])}update(e,t,s){const n=this.get(e,s);if(n===void 0)throw new Error(`"${e}" not found, use \`set\``);this.set(e,t(n),!1,s)}listen(e,t,s=!1,n){if(s){const i=this.get(e,n);i!==void 0&&setTimeout(()=>t(i))}return this.events.addListener(e,t)}}class L{constructor(e){this.url="",this.socket=null,this.events=new u,this.reconnectInterval=1e3,this.timeout=null,this.open=!1,this.onClose=()=>{this.timeout!==null&&(clearTimeout(this.timeout),this.timeout=null),this.open&&(this.open=!1,this.events.dispatch("close",this)),this.timeout=setTimeout(async()=>{console.debug(`WS: try to reconnect to "${this.url}"`),await this.connect()},this.reconnectInterval)},this.onOpen=()=>{console.debug(`WS: connected to "${this.url}"`),this.open||(this.open=!0,this.events.dispatch("open",this))},this.onMessage=async t=>{const s=JSON.parse(await t.data.text());console.debug("WS: Got a message:",s),this.events.dispatch("message",s)},this.url=e}isOpen(){return this.open}async connect(){this.socket&&this.close();const e=this.url;console.debug(`Try to connect WebSocket to ${e}`),this.socket=new WebSocket(e),this.socket.addEventListener("close",this.onClose),this.socket.addEventListener("open",this.onOpen),this.socket.addEventListener("message",this.onMessage)}close(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.socket&&(this.socket.removeEventListener("close",this.onClose),this.isOpen()&&this.socket.close(),this.socket=null)}}const $={onDragStart:null,onDragging:null,onDragEnd:null};function w(r,e,t){t={...$,...t};const s=[...r.children].indexOf(e);return e.draggable=!0,e.ondragstart=n=>{n.dataTransfer&&(n.dataTransfer.effectAllowed="move",n.dataTransfer.dropEffect="move"),r.classList.add("ui-dragging"),t.onDragStart&&t.onDragStart(s)},e.ondragover=n=>(n.preventDefault(),!1),e.ondragenter=n=>{n.preventDefault(),[...r.children].forEach((i,c)=>{if(c===s){i.style.background="var(--ui-primary)",i.style.color="var(--ui-primary-text)";return}i.style.background="inherit",i.style.color="inherit"}),t.onDragging&&t.onDragging(s)},e.ondrop=n=>{n.preventDefault(),n.dataTransfer&&(n.dataTransfer.dropEffect="move"),r.classList.remove("ui-dragging"),t.onDragEnd&&t.onDragEnd(s),[...r.children].forEach(i=>{i.style.background="inherit",i.style.color="inherit"})},()=>{e.draggable=!1,e.ondragstart=null,e.ondragover=null,e.ondragenter=null,e.ondrop=null}}const T={onDragStart:null,onDragEnd:null};function D(r,e){e={...T,...e};let t=null,s=null,n=null,i=!1,c="",f="";const b=o=>{const d=o.currentTarget;!t&&Array.from(d.classList).includes("draggable")&&(s=new Date().getTime(),t=d,n&&clearTimeout(n),n=setTimeout(()=>{t&&(c=t.style.color,f=t.style.backgroundColor,t.style.color="var(--ui-primary-text)",t.style.backgroundColor="var(--ui-primary)",r.classList.add("ui-dragging"),i=!0,e!=null&&e.onDragStart&&e.onDragStart())},200))},E=o=>{if(!s||!t)return;if(!i&&new Date().getTime()-s<200){v();return}o.preventDefault(),i||(i=!0,e!=null&&e.onDragStart&&e.onDragStart());let d;if(window.TouchEvent&&o instanceof TouchEvent){const p=o.targetTouches[0];d={clientX:p.clientX,clientY:p.clientY}}else d={clientX:o.clientX,clientY:o.clientY};let a=document.elementFromPoint(d.clientX,d.clientY);if(a){for(;!a.classList.contains("draggable")&&a.parentElement;)a=a.parentElement;a.classList.contains("draggable")&&((()=>{let h=t==null?void 0:t.previousElementSibling;for(;h;){if(h===a)return!0;h=h.previousElementSibling}return!1})()?r.insertBefore(t,a):r.insertBefore(t,a.nextElementSibling))}},v=()=>{n!==null&&(clearTimeout(n),n=null),t&&(t.style.color=c,t.style.backgroundColor=f,t=null),s=null,r.classList.remove("ui-dragging"),i&&(i=!1,e!=null&&e.onDragEnd&&e.onDragEnd())};return[...r.children].forEach(o=>{o.classList.add("draggable"),o.onmousedown=b,o.ontouchstart=b,o.onmousemove=E,o.ontouchmove=E,r.onmouseleave=o.onmouseup=v,o.ontouchend=v}),()=>{[...r.children].forEach(o=>{o.classList.remove("draggable"),o.onmousedown=null,o.ontouchstart=null,o.onmousemove=null,o.ontouchmove=null,r.onmouseleave=o.onmouseup=null,o.ontouchend=null})}}const O=Object.freeze(Object.defineProperty({__proto__:null,createMobile:D,createNative:w},Symbol.toStringTag,{value:"Module"})),y={color:"var(--ui-ripple-color, currentColor)",opacity:"var(--ui-ripple-opacity, 0.2)",centered:!1,spreadDuration:".4s",spreadTiming:"linear",clearDuration:"1s",clearTiming:"ease-in-out",usePointer:!1};function x(r,e){e={...y,...e||{}};let t=null;const s=f=>{t=g(f,e),r.addEventListener("pointermove",i)},n=()=>{r.removeEventListener("pointermove",i),m(t),t=null},i=()=>n(),c=f=>{t=g(f,e),m(t),t=null};return r.classList.add("ripple-container"),r.style.overflow="hidden",e.usePointer?(r.addEventListener("pointerdown",s),r.addEventListener("pointerup",n),r.addEventListener("pointerleave",n)):r.addEventListener("click",c),()=>{if(r.classList.remove("ripple-container"),e.usePointer){r.removeEventListener("pointerdown",s),r.removeEventListener("pointerup",n),r.removeEventListener("pointerleave",n),r.removeEventListener("pointermove",i);return}r.removeEventListener("click",c)}}function g(r,e){const t=document.createElement("div"),s=r.currentTarget;s.appendChild(t),t.classList.add("ripple"),t.style.position="absolute",t.style.color="inherit",t.style.borderRadius="50%",t.style.pointerEvents="none",t.style.width="100px",t.style.height="100px",t.style.marginTop="-50px",t.style.marginLeft="-50px",t.style.opacity=`${e.opacity}`,t.style.backgroundColor=`${e.color}`,t.style.transform="scale(0) translate(0, 0)",t.style.transition=`transform ${e.spreadDuration} ${e.spreadTiming} 0s,opacity ${e.clearDuration} ${e.clearTiming} 0s`;const n=s.getBoundingClientRect();e.centered?(t.style.top=`${n.height/2}px`,t.style.left=`${n.width/2}px`):(t.style.top=`${r.clientY-n.top}px`,t.style.left=`${r.clientX-n.left}px`);const i=Math.max(n.width,n.height)*.02;return t.style.transform=`scale(${i}) translate(0, 0)`,t}function m(r){r&&(r.addEventListener("transitionend",e=>{e.propertyName==="opacity"&&r.remove()}),r.style.opacity="0")}const C=Object.freeze(Object.defineProperty({__proto__:null,create:x,defaultOptions:y,start:g,stop:m},Symbol.toStringTag,{value:"Module"}));function _(r){let e=null;async function t(s){if(e!==null&&e.onDestroy&&e.onDestroy(),e=s,e.title!==void 0){const n=document.querySelector("head > title");n&&(n.innerHTML=e.title)}e.onMount&&e.onMount()}window.addEventListener("hashchange",()=>{const s=window.location.hash.replace("#","");let n="";for(const i of Object.keys(r))s.startsWith(i)&&i>n&&(n=i);if(!n){const i=r["/"];if(i===void 0){console.warn(`Window location “${s}” is missing in routes, and the fallback route “/“ is also missing.`);return}t(i);return}t(r[n])}),window.dispatchEvent(new Event("hashchange"))}function j(r,e){let t;if(r?t=`?${Object.entries(r).map(([s,n])=>`${encodeURIComponent(s)}=${encodeURIComponent(n)}`).join("&")}`:t="",!e&&!t){location.hash="";return}location.hash=`#${encodeURIComponent(e)}`+(t?`&${t}`:"")}function P(){const r={};return location.hash.replace(/^#.*\?/,"").split("?").forEach(e=>{e.split("&").forEach(t=>{const[s,n]=t.split("=");r[decodeURIComponent(s)]=decodeURIComponent(n)})}),r}const M=Object.freeze(Object.defineProperty({__proto__:null,hash:Object.freeze(Object.defineProperty({__proto__:null,getSearchParam:P,goTo:j,init:_},Symbol.toStringTag,{value:"Module"}))},Symbol.toStringTag,{value:"Module"}));function k(){return/(android)/i.test(navigator.userAgent)}function I(r){return Object.entries(r).map(([e,t])=>`${e.replace(/[A-Z]/g,s=>`-${s.toLowerCase()}`)}:${t}`).join(";")+";"}l.Events=u,l.Store=S,l.WS=L,l.draggable=O,l.isAndroid=k,l.ripple=C,l.router=M,l.styles=I,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
